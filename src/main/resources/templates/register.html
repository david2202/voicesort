<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/web/thymeleaf/layout"
      layout:decorate="~{layout}"
      th:with="currentPage='home'">
<body>
<div layout:fragment="content">
    <p id="uuid">Click Generate to create a new device id</p>
    <button type="button" id="generate" class="btn btn-primary">Generate</button>
    <script th:inline="javascript">
    /*<![CDATA[*/
    $("#generate").click(function(data) {
        var d = new Date();
        // 365 days
        d.setTime(d.getTime() + (365*24*60*60*1000));
        var uuid = /*[[${uuid}]]*/'73be5956-140f-4fc7-b404-ba4931aa9045';
        var device = "device=" + uuid;
        var expires = "expires="+ d.toUTCString();
        var path = "path=/"

        var cookie = device + ";" + expires + ";" + path;
        if (!window.location.href.includes("8443") && !window.location.href.includes("8080")) {
            cookie += ";secure";
        }

        document.cookie = cookie;
        $("#uuid").html(uuid);
    });
    /*]]>*/
    </script>
</div>
</body>
</html>
